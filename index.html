<!DOCTYPE HTML>
<html>
    <head>
        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
        </style>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body data-rsssl=1>
        <canvas id="myCanvas" width="700" height="400"></canvas>
        <script src = "script.js"></script>
        <script src = "compiler.js"></script>

        <input type="text" id="var-name">
        <input type="submit" id="submit-name" value="submit">
        <input type="submit" id="new-cons" value="+">
        <input type="submit" id="new-connect" value="->">
        <br />
        <br />
        <input type="submit" id="compile" value="compile">
        <br />
        <textarea id="lisp-code"></textarea>

        <script>
            var canvas = document.getElementById('myCanvas');
            var ctx = canvas.getContext('2d');

            let cells = [
                newConsCell(10, 100),
                newConsCell(80, 100),
            ];

            let scene = new Scene(canvas, ctx, cells);


            document.getElementById('submit-name').onclick = () => scene.setCellValue(
                document.getElementById('var-name').value );

            document.getElementById('compile').onclick = () => {
                let src_cell = scene.context[ scene.selected[0] ];
                let cons_list = cells.filter( c => c.type == 'cons');

                let code_str = compile(src_cell, cons_list);
                document.getElementById('lisp-code').value = code_str;
            };

            document.getElementById('new-connect').onclick = () => { scene.connecting = true; };
            document.getElementById('new-cons').onclick = () => {
                scene.addConsCell(10,10);
            }
            // an array of objects that define different shapes
            //var shapes=[];
            // define 2 rectangles
            //shapes.push({x:10,y:100,width:30,height:30,fill:"#444444",isDragging:false});
            //shapes.push({x:80,y:100,width:30,height:30,fill:"#ff550d",isDragging:false});
            // define 2 circles
            //shapes.push({x:150,y:100,r:10,fill:"#800080",isDragging:false});
            //shapes.push({x:200,y:100,r:10,fill:"#0c64e8",isDragging:false});

            // listen for mouse events
            canvas.onmousedown = scene.myDown;
            canvas.onmouseup = scene.myUp;
            canvas.onmousemove = scene.myMove;

            // call to draw the scene
            scene.draw();
        </script>
    </body>
</html>
