<!DOCTYPE HTML>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<html>
    <head>
        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
        </style>

        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body data-rsssl=1>
        <div class="wrap">
        <div id="main">
            <canvas id="myCanvas"></canvas>
        </div>

        <div class="ui">
            <input type="text" id="var-name">
            <input type="text"   id="list-size" size="1">
            <input type="submit" id="new-cell" value="+">
            <input type="submit" id="remove-cons" value="-">
            <input type="submit" id="new-connect" value="->">
            <input type="submit" id="compile" value="eval">
            <br />
            <textarea id="lisp-code"></textarea>

            <div class="control-panel">
                <!--<h3 style="font-size:3vw" align="center">Context</h3>-->
                <ul id="context"></ul>
            </div>
        </div>

        <!-- <textarea id="debug"></textarea> -->

        <script src = "./scene.js"></script>
        <script src = "./interpreter.js"></script>
        <script src = "./auxillery.js"></script>
        <script>
            //const width  = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            //const height = window.innerHeight|| document.documentElement.clientHeight|| document.body.clientHeight;
            //const UI_height = height / 3;

            let canvas = document.getElementById('myCanvas');
            fitToContainer(canvas, null);

            let ctx = canvas.getContext('2d');

            let cells = [
                newList(10, 50, ['define', 'test', '']),
                newList(10, 100, ['lambda', 'x', 'x']),
            ];

            // Special form functions and their arity
            const special_fns = {
                'lambda': 2,
                'quote': 1,
                'define': 2,
                'if': 3,
            };

            let scene = new Scene(canvas, ctx, cells);
            // A repl context for our definitions
            let global_env = std_env();

            // Load in any locally saved std env and definitions
            loadLocalEnv(global_env);
            drawContext();

/*
            function loadLocalEnv (global_env) {
                const loc_defs   = localStorage.getItem('defs');
                if ( loc_defs != 'undefined' && loc_defs ) {
                    const data = JSON.parse(loc_defs);
                    defs = {...defs, ...data}
                    importDefs(data, global_env);
                }
            }
            */

        </script>
        <script src = "./controller.js"></script>
        </div>
    </body>
</html>
